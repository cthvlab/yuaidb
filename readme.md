# YUAIDB: Your Uberfast Async In-memory DataBase üöÄ‚ú®

–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ **YUAIDB** ‚Äî –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è –∂–∏–≤—ë—Ç –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–∫–µ, –≤—ã–ø–æ–ª–Ω—è–µ—Ç SQL Like –∑–∞–ø—Ä–æ—Å—ã –∫–∞–∫ Postgres, —É–¥–µ–ª—ã–≤–∞–µ—Ç Redis –≤ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –¥–∏—Å–∫ –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –≤—ã —Å–∫–∞–∂–µ—Ç–µ "–ì–¥–µ –º–æ–π –∑–∞–∫–∞–∑?". –ù–∞–ø–∏—Å–∞–Ω–∞ –Ω–∞ Rust, –ø–æ—Ç–æ–º—É —á—Ç–æ –º—ã –ª—é–±–∏–º –±—ã—Å—Ç—Ä—ã–µ, –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∏ –ø—Ä–æ—Å—Ç—ã–µ —à—Ç—É–∫–∏. üòé

## –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ? ü§î

YUAIDB ‚Äî —ç—Ç–æ in-memory –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è **–∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**, –≥–¥–µ –≤–∞–∂–Ω–∞ –º–æ–ª–Ω–∏–µ–Ω–æ—Å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —á—Ç–µ–Ω–∏—è –∏ –∑–∞–ø–∏—Å–∏. –ú—ã —Å–æ–∑–¥–∞–Ω—ã –¥–ª—è "–≥–æ—Ä—è—á–∏—Ö" —à—Ç—É–∫ –≤—Ä–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å–µ—Å—Å–∏–π, –∑–∞–∫–∞–∑–æ–≤ –≤ —Ä–∞–±–æ—Ç–µ –∏–ª–∏ –ª—é–±—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –∏ –ø–æ–ª—É—á–∞—Ç—å –Ω–∞ –ª–µ—Ç—É. 

- **–°–∫–æ—Ä–æ—Å—Ç—å**: O(1) –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ –ø–∞–º—è—Ç–∏, –ø–ª—é—Å –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º —á–µ—Ä–µ–∑ `tokio`.
- **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å**: –ö–∞–∂–¥–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ä–∞–∑—É –Ω–∞ –¥–∏—Å–∫ ‚Äî –Ω–∏–∫–∞–∫–∏—Ö –ø–æ—Ç–µ—Ä—å –ø—Ä–∏ —Å–±–æ—è—Ö.
- **–ì–∏–±–∫–æ—Å—Ç—å**: JOIN, WHERE, ORDER BY, GROUP BY –∏ –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫!
- **–†–µ–∂–∏–º—ã**: –í—Å—Ç—Ä–∞–∏–≤–∞–µ–º–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∏–ª–∏ gRPC-—Å–µ—Ä–≤–∏—Å ‚Äî –≤—ã–±–∏—Ä–∞–π—Ç–µ —Å–≤–æ–π —Å—Ç–∏–ª—å.

## –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ? üéâ

- –•–æ—Ç–∏—Ç–µ –±–∞–∑—É –¥–ª—è –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –±—ã—Å—Ç—Ä–µ–µ Redis? YUAIDB –≤ –¥–µ–ª–µ.
- –ù—É–∂–Ω–∞ –∂–µ–ª–µ–∑–Ω–∞—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å –¥–ª—è —Å–µ—Å—Å–∏–π –∏–ª–∏ –∑–∞–∫–∞–∑–æ–≤ –≤ —Ä–∞–±–æ—Ç–µ? –ú—ã –ø–∏—à–µ–º –Ω–∞ –¥–∏—Å–∫ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —á–∏—Ö–∞.
- –£ –≤–∞—Å –Ω–µ —Ç–∞–∫ –º–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö? –≠—Ç–æ Postgres –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–∫–µ!
- –õ—é–±–∏—Ç–µ Rust –∏ —Ö–æ—Ç–∏—Ç–µ –±–∞–∑—É —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–º? –í—ã –ø–æ –∞–¥—Ä–µ—Å—É!

**–í–∞–∂–Ω–æ**: YUAIDB ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ —Ç–µ—Ä–∞–±–∞–π—Ç—ã –∏ –∫–ª–∞—Å—Ç–µ—Ä—ã, –¥–ª—è —ç—Ç–æ–≥–æ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ –±–∞–∑—ã —Å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–µ–π –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ YUAIDB —ç—Ç–æ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç? üõ†Ô∏è

YUAIDB –¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ –ø–∞–º—è—Ç–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `DashMap` –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏. 
–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ (`insert`, `update`, `delete`) –≤—Å—ë —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –ø–∏—à–µ—Ç—Å—è –≤ `.bin` —Ñ–∞–π–ª—ã –Ω–∞ –¥–∏—Å–∫ ‚Äî –Ω–∏–∫–∞–∫–∏—Ö "–æ–π, –∑–∞–±—ã–ª —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å". 
–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫? –í—Å—ë –≥—Ä—É–∑–∏—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –≤ RAM, –∫–∞–∫ –ø–æ –≤–æ–ª—à–µ–±—Å—Ç–≤—É.


### –ö–ª—é—á–µ–≤—ã–µ —Ñ–∏—á–∏:
- **O(1) –≤ –ø–∞–º—è—Ç–∏**: –ß–∏—Å—Ç–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π –±–µ–∑ –∑–∞–ø–∏—Å–∏ –Ω–∞ –¥–∏—Å–∫.
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ –¥–∏—Å–∫**: –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, —á—Ç–æ–±—ã –Ω–∏ –æ–¥–∏–Ω –∑–∞–∫–∞–∑ –∏–ª–∏ —Å–µ—Å—Å–∏—è –Ω–µ –ø–æ—Ç–µ—Ä—è–ª–∏—Å—å.
- **–ò–Ω–¥–µ–∫—Å—ã**: –û–±—ã—á–Ω—ã–µ –∏ –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–µ ‚Äî –∏—â–∏—Ç–µ –∫–∞–∫ –ø—Ä–æ—Ñ–∏.
- **JOIN-—ã**: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ, —Å –∫—ç—à–µ–º ‚Äî –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.
- **gRPC**: –°–µ—Ä–≤–∏—Å–Ω—ã–π —Ä–µ–∂–∏–º –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å —á–µ—Ä–µ–∑ –∫—Ä—É—Ç–æ–π –ø—Ä–æ—Ç–æ–∫–æ–ª.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫ üé¨

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**:
   ```bash
   git clone https://github.com/cthvlab/yuaidb.git
   cd yuaidb
   ```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–∞–∫ –≤—Å—Ç—Ä–∞–∏–≤–∞–µ–º—É—é –±–∞–∑—É**:
   ```bash
   cargo run
   ```

3. **–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥–∞** (`dbconfig.toml`):
   ```toml
   
    [[tables]]
   name = "pirates"
   [[tables.fields]]
   name = "id"
   indexed = true
   autoincrement = true
   unique = true
   [[tables.fields]]
   name = "name"
   [[tables.fields]]
   name = "ship_id"
   
   [[tables]]
   name = "ships"
   [[tables.fields]]
   name = "ship_id"
   indexed = true
   autoincrement = true
   unique = true
   [[tables.fields]]
   name = "name"
   [[tables.fields]]
   name = "speed"
   
   ```

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è üíª

### –í—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π —Ä–µ–∂–∏–º
```rust
use yuaidb::Database;

#[tokio::main]
async fn main() {
    let db = Database::new("./data", "./config.toml").await;

    db.insert("pirates")
        .values(vec![("pirate_id", "1"), ("name", "–ö–∞–ø–∏—Ç–∞–Ω –î–∂–µ–∫ –í–æ—Ä–æ–±–æ—Ç"), ("ship_id", "101")])
        .execute(&db)
        .await;

    db.insert("pirates")
        .values(vec![("pirate_id", "2"), ("name", "–õ–∏—Ö–æ–π –ë–∏–ª–ª"), ("ship_id", "102")])
        .execute(&db)
        .await;

    db.insert("ships")
        .values(vec![("ship_id", "101"), ("name", "–ß—ë—Ä–Ω–∞—è –ö–æ–º–µ—Ç–∞"), ("speed", "0.9c")])
        .execute(&db)
        .await;

    db.insert("ships")
        .values(vec![("ship_id", "102"), ("name", "–ê—Å—Ç–µ—Ä–æ–∏–¥–Ω—ã–π –®—Ç–æ—Ä–º"), ("speed", "0.7c")])
        .execute(&db)
        .await;

    println!("–ö—Ç–æ –Ω–∞ —á—ë–º –ª–µ—Ç–∞–µ—Ç:");
    if let Some(rows) = db.select("pirates")
        .alias("p")
        .fields(vec!["p.name", "s.name", "s.speed"])
        .join("ships", "s", "s.ship_id", "p.ship_id")
        .execute(&db)
        .await
    {
        for row in rows {
            println!(
                "–ü–∏—Ä–∞—Ç {} —É–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ—Ä–∞–±–ª—ë–º {} —Å–æ —Å–∫–æ—Ä–æ—Å—Ç—å—é {}",
                row.get("p.name").unwrap(),
                row.get("s.name").unwrap(),
                row.get("s.speed").unwrap()
            );
        }
    }

    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ—Ä–∞–±–ª—å –¥–ª—è –î–∂–µ–∫–∞
    db.update("pirates")
        .values(vec![("ship_id", "102")]) // –ú–µ–Ω—è–µ–º –∫–æ—Ä–∞–±–ª—å –Ω–∞ "–ê—Å—Ç–µ—Ä–æ–∏–¥–Ω—ã–π –®—Ç–æ—Ä–º"
        .where_eq("pirate_id", "1")
        .execute(&db)
        .await;

    println!("\n–ü–æ—Å–ª–µ —Å–º–µ–Ω—ã –∫–æ—Ä–∞–±–ª—è:");
    if let Some(rows) = db.select("pirates")
        .alias("p")
        .fields(vec!["p.name", "s.name"])
        .join("ships", "s", "s.ship_id", "p.ship_id")
        .where_eq("p.pirate_id", "1")
        .execute(&db)
        .await
    {
        for row in rows {
            println!("–¢–µ–ø–µ—Ä—å {} –ª–µ—Ç–∞–µ—Ç –Ω–∞ {}", row.get("p.name").unwrap(), row.get("s.name").unwrap());
        }
    }
}
```
#### SQL-–ø–æ–¥–æ–±–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å:
```SQL
.select("pirates").alias("p").fields(vec!["p.name", "s.name"]).join("ships", "s", "s.ship_id", "p.ship_id") 
SELECT p.name, s.name FROM pirates p JOIN ships s ON s.ship_id = p.ship_id.
```


### gRPC-—Å–µ—Ä–≤–∏—Å
```bash
grpcurl \
  -plaintext \
  -d '{
    "table": "pirates",
    "fields": ["p.name", "s.name"],
    "alias": "p",
    "joins": [
      {
        "table": "ships",
        "alias": "s",
        "on_left": "s.ship_id",
        "on_right": "p.ship_id"
      }
    ],
    "where_eq": "p.pirate_id = \"1\""
  }' \
  localhost:50051 yuaidb.DatabaseService/ExecuteQuery
```

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å Redis üòè

| –§–∏—á–∞             | YUAIDB (–±–µ–∑ –¥–∏—Å–∫–∞) | YUAIDB (—Å –¥–∏—Å–∫–æ–º) | Redis (–±–µ–∑ AOF) | Redis (AOF every write) |
|------------------|--------------------|-------------------|-----------------|-------------------------|
| **–°–∫–æ—Ä–æ—Å—Ç—å –∑–∞–ø–∏—Å–∏** | ~1.2M –æ–ø/—Å–µ–∫       | ~666k –æ–ø/—Å–µ–∫      | ~1M –æ–ø/—Å–µ–∫      | ~50k‚Äì100k –æ–ø/—Å–µ–∫        |
| **–°–∫–æ—Ä–æ—Å—Ç—å —á—Ç–µ–Ω–∏—è** | ~1.1M –æ–ø/—Å–µ–∫       | ~1.1M –æ–ø/—Å–µ–∫      | ~1M –æ–ø/—Å–µ–∫      | ~1M –æ–ø/—Å–µ–∫              |
| **JOIN –∏ WHERE**    | –ï—Å—Ç—å!              | –ï—Å—Ç—å!             | –ù–µ—Ç             | –ù–µ—Ç                     |
| **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ**      | –ù–µ—Ç                | –ö–∞–∂–¥—É—é –æ–ø–µ—Ä–∞—Ü–∏—é   | –ù–µ—Ç             | –ö–∞–∂–¥—É—é –æ–ø–µ—Ä–∞—Ü–∏—é (AOF)   |
| **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å**     | –ü–æ—Ç–µ—Ä—è –ø—Ä–∏ —Å–±–æ–µ    | 100% —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å  | –ü–æ—Ç–µ—Ä—è –ø—Ä–∏ —Å–±–æ–µ | 100% —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å       |

### –ü–æ—è—Å–Ω–µ–Ω–∏—è:
- **YUAIDB (–±–µ–∑ –¥–∏—Å–∫–∞)**: –ß–∏—Å—Ç–∞—è O(1) —Å–∫–æ—Ä–æ—Å—Ç—å –≤ –ø–∞–º—è—Ç–∏ ‚Äî –º—ã –æ–±–≥–æ–Ω—è–µ–º Redis –∑–∞ —Å—á—ë—Ç –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞ –∏ –≤—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ—Å—Ç–∏.
- **YUAIDB (—Å –¥–∏—Å–∫–æ–º)**: –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å –Ω–∞ –¥–∏—Å–∫ –∑–∞–º–µ–¥–ª—è–µ—Ç, –Ω–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (—Å–µ—Å—Å–∏–π, –∑–∞–∫–∞–∑–æ–≤).
- **Redis (–±–µ–∑ AOF)**: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å, –Ω–æ –¥–∞–Ω–Ω—ã–µ —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ —Å–±–æ–µ, –ø–æ–∫–∞ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω RDB (—Å–Ω–∏–º–∫–∏) –∏–ª–∏ AOF (–ª–æ–≥).
- **Redis (AOF every write)**: –ü–æ–ª–Ω–∞—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å —Å `fsync` –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å, –Ω–æ —Å–∫–æ—Ä–æ—Å—Ç—å –ø–∞–¥–∞–µ—Ç –≤ —Ä–∞–∑—ã.

**–í—ã–≤–æ–¥**: –î–ª—è –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö YUAIDB –≤ –ø–∞–º—è—Ç–∏ –±—ã—Å—Ç—Ä–µ–µ Redis, –∞ —Å –¥–∏—Å–∫–æ–º ‚Äî –∏–¥–µ–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏. Redis —Å AOF "every write" —Å–∏–ª—å–Ω–æ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—Ç –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

## –õ–∏—Ü–µ–Ω–∑–∏—è üìú

MIT ‚Äî –±–µ—Ä–∏—Ç–µ, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ, –≤–µ—Å–µ–ª–∏—Ç–µ—Å—å!

YUAIDB ‚Äî —ç—Ç–æ –≤–∞—à –±–∏–ª–µ—Ç –≤ –º–∏—Ä —Å–∫–æ—Ä–æ—Å—Ç–∏, –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏ –∏ Rust-–º–∞–≥–∏–∏ –¥–ª—è –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ, –∏ –ø—É—Å—Ç—å –≤–∞—à–∏ –∑–∞–∫–∞–∑—ã –∏ —Å–µ—Å—Å–∏–∏ –ª–µ—Ç–∞—é—Ç –∫–∞–∫ —Ä–∞–∫–µ—Ç–∞! üöÄ


## –ê–≤—Ç–æ—Ä—ã

–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ–º –Æ–ê–ò [yuai.ru](https://yuai.ru) 

